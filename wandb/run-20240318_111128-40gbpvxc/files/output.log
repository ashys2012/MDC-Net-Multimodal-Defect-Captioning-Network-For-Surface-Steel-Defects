Shape of self.encoder_pos_embed: torch.Size([1, 196, 512])
skipping pos_embed...
skipping pos_embed...
num_training_steps is: 9000
num_warmup_steps is: 900
Epoch 1/200
  0%|                                                                                                                                            | 0/45 [00:00<?, ?it/s]
BLEU Score: 0.0004429106611939321
---------#################################---------------------
THe giou_bbox_loss is tensor(1.4062)

  2%|█▉                                                                                     | 1/45 [00:02<02:03,  2.82s/it, iou_loss=1.41, lr=0.000000, train_loss=3.09]
BLEU Score: 0.0004055382417906339
---------#################################---------------------
THe giou_bbox_loss is tensor(1.2188)
THe giou_bbox_score is [tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([])]
BLEU Score: 0
---------#################################---------------------
THe giou_bbox_loss is tensor(1.2500)

  4%|███▊                                                                                   | 2/45 [00:04<01:32,  2.16s/it, iou_loss=1.31, lr=0.000000, train_loss=3.02]
BLEU Score: 0.0002299884818003046
---------#################################---------------------
THe giou_bbox_loss is tensor(1.1250)

  7%|██████                                                                                    | 3/45 [00:06<01:21,  1.94s/it, iou_loss=1.29, lr=0.000000, train_loss=3]
BLEU Score: 0.00018391734559119517
---------#################################---------------------
THe giou_bbox_loss is tensor(1.1562)

  9%|███████▋                                                                               | 4/45 [00:07<01:15,  1.84s/it, iou_loss=1.25, lr=0.000000, train_loss=2.97]
BLEU Score: 0.00011640625124051226
---------#################################---------------------
THe giou_bbox_loss is tensor(0.5312)

 13%|███████████▌                                                                           | 6/45 [00:11<01:08,  1.75s/it, iou_loss=1.11, lr=0.000000, train_loss=2.86]
BLEU Score: 0.00042746158886407634
---------#################################---------------------
THe giou_bbox_loss is tensor(1.2188)
THe giou_bbox_score is [tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([]), tensor([])]
BLEU Score: 0.00016965450281073916
---------#################################---------------------
THe giou_bbox_loss is tensor(1.4062)

 16%|█████████████▌                                                                         | 7/45 [00:14<01:16,  2.02s/it, iou_loss=1.13, lr=0.000000, train_loss=2.87]
Traceback (most recent call last):
  File "/mnt/sdb/2024/pix_2_seq_with_captions_march/trail_01.py", line 208, in <module>
    train_eval(model,
  File "/mnt/sdb/2024/pix_2_seq_with_captions_march/trail_01.py", line 166, in train_eval
    train_loss = train_epoch(model, train_loader, optimizer, lr_scheduler if step == 'batch' else None, criterion, logger = None, iou_loss_weight=0.8)
  File "/mnt/sdb/2024/pix_2_seq_with_captions_march/train_val_epoch.py", line 123, in train_epoch
    _, gt_bboxes, _ = extract_ground_truth(y_expected_adjusted, tokenizer)  # You need to implement this based on your dataset
  File "/mnt/sdb/2024/pix_2_seq_with_captions_march/iou_bbox.py", line 137, in extract_ground_truth
    labels, bboxes, caption = tokenizer.decode(tokens)
  File "/mnt/sdb/2024/pix_2_seq_with_captions_march/data_processing.py", line 318, in decode
    tokens = tokens[tokens != self.PAD_code]
KeyboardInterrupt